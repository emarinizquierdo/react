(function(){"use strict";var t=function(t){t=t||{};var e={},n=function(t,e){t.replace(/\S+/g,e)},r=function(e,n){Object.defineProperty(t,e,{value:n,enumerable:false,writable:false,configurable:false})};r("on",function(r,i){if(typeof i!="function")return t;n(r,function(t,n){(e[t]=e[t]||[]).push(i);i.typed=n>0});return t});r("off",function(r,i){if(r=="*")e={};else{n(r,function(t){if(i){var n=e[t];for(var r=0,f;f=n&&n[r];++r){if(f==i)n.splice(r--,1)}}else delete e[t]})}return t});r("one",function(e,n){function r(){t.off(e,r);n.apply(t,arguments)}return t.on(e,r)});r("trigger",function(r){var i=arguments.length-1,f=new Array(i);for(var u=0;u<i;u++){f[u]=arguments[u+1]}n(r,function(n){var r=(e[n]||[]).slice(0);for(var i=0,u;u=r[i];++i){if(u.busy)return;u.busy=1;try{u.apply(t,u.typed?[n].concat(f):f)}catch(o){}if(r[i]!==u){i--}u.busy=0}if(e.all&&n!="all")t.trigger.apply(t,["all",n].concat(f))});return t});return t};var e=/^.+?\/+[^\/]+/,n="EventListener",r="remove"+n,i="add"+n,f="hasAttribute",u="replace",o="popstate",a="hashchange",c="trigger",s=3,l=window,h=document,p=l.history.location||l.location,d=P.prototype,v=h&&h.ontouchstart?"touchstart":"click",m=false,y=t(),g=false,b,w,$,x,A,K=[],N=0;function O(t){return t.split(/[\/?#]/)}function S(t,e){var n=new RegExp("^"+e[u](/\*/g,"([^/?#]+?)")[u](/\.\./,".*")+"$"),r=t.match(n);if(r)return r.slice(1)}function T(t,e){var n;return function(){clearTimeout(n);n=setTimeout(t,e)}}function E(t){b=T(L,1);l[i](o,b);l[i](a,b);h[i](v,R);if(t)L(true)}function P(){this.$=[];t(this);y.on("stop",this.s.bind(this));y.on("emit",this.e.bind(this))}function j(t){return t[u](/^\/|\/$/,"")}function k(t){return typeof t=="string"}function q(t){return(t||p.href)[u](e,"")}function D(t){return w[0]=="#"?(t||p.href).split(w)[1]||"":q(t)[u](w,"")}function L(t){var e=N==0;if(s<=N)return;N++;K.push(function(){var e=D();if(t||e!=$){y[c]("emit",e);$=e}});if(e){while(K.length){K[0]();K.shift()}N=0}}function R(t){if(t.which!=1||t.metaKey||t.ctrlKey||t.shiftKey||t.defaultPrevented)return;var n=t.target;while(n&&n.nodeName!="A")n=n.parentNode;if(!n||n.nodeName!="A"||n[f]("download")||!n[f]("href")||n.target&&n.target!="_self"||n.href.indexOf(p.href.match(e)[0])==-1)return;if(n.href!=p.href){if(n.href.split("#")[0]==p.href.split("#")[0]||w!="#"&&q(n.href).indexOf(w)!==0||!_(D(n.href),n.title||h.title))return}t.preventDefault()}function _(t,e){e=e||h.title;history.pushState(null,e,w+j(t));h.title=e;g=false;L();return g}d.m=function(t,e){if(k(t)&&(!e||k(e)))_(t,e);else if(e)this.r(t,e);else this.r("@",t)};d.s=function(){this.off("*");this.$=[]};d.e=function(t){this.$.concat("@").some(function(e){var n=(e=="@"?x:A)(j(t),j(e));if(typeof n!="undefined"){this[c].apply(null,[e].concat(n));return g=true}},this)};d.r=function(t,e){if(t!="@"){t="/"+j(t);this.$.push(t)}this.on(t,e)};var z=new P;var B=z.m.bind(z);B.create=function(){var t=new P;t.m.stop=t.s.bind(t);return t.m.bind(t)};B.base=function(t){w=t||"#";$=D()};B.exec=function(){L(true)};B.parser=function(t,e){if(!t&&!e){x=O;A=S}if(t)x=t;if(e)A=e};B.query=function(){var t={};p.href[u](/[?&](.+?)=([^&]*)/g,function(e,n,r){t[n]=r});return t};B.stop=function(){if(m){l[r](o,b);l[r](a,b);h[r](v,R);y[c]("stop");m=false}};B.start=function(t){if(!m){if(document.readyState=="complete")E(t);else l[i]("load",function(){setTimeout(function(){E(t)},1)});m=true}};B.base();B.parser();window.route=B})();